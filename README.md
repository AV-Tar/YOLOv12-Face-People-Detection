# YOLOv12 Face & People Detection

Данный репозиторий содержит примеры использования модели **YOLOv12** для детекции лиц и людей в реальном времени (с веб-камеры) и при анализе видеопотока (из файла).

### Описание проекта

Проект состоит из двух скриптов, демонстрирующих базовую работу с моделью `yolov12n-face.pt`:

1.  **`face_recognition_webcam.py`** — детекция лиц с веб-камеры с возможностью сохранения скриншотов.
2.  **`people_recognition_video_stream.py`** — детекция людей в видеопотоке из файла с сохранением каждого кадра.

### Использование

**Скачайте веса модели:**
    Поместите файл модели `yolov12n-face.pt` в корневую папку проекта.
    *(Примечание: файла нет, его необходимо скачать отдельно, так как в репозиторий он не включен из-за большого размера).*

## 1. Детекция лиц с веб-камеры 

**файл: face_recognition_webcam.py**

Скрипт подключается к веб-камере (индекс 0), обнаруживает лица и отображает результат. Каждый 10-й кадр с лицами сохраняется в папку `screens/`.

## Управление:

Нажмите ESC для выхода.

Настройки:
```
if i % 10 == 0 — регулирует частоту сохранения кадров.
if len(results[0].boxes) > 0 — отвечает за сохранение только тех кадров, где есть лица (раскомментируйте, если нужно включить фильтр).
```

# 2. Детекция людей из видеофайла

**файл: people_recognition_video_stream.py**

Скрипт читает видеофайл people-walking.mp4, детектирует объекты (в данном случае лица/люди, в зависимости от модели) и сохраняет каждый кадр в виде PNG-файла с именем [номер_кадра].png.

**Внимание:**

Скрипт сохраняет изображения в ту же папку, где запущен. Убедитесь, что там достаточно места, или измените путь сохранения.

## Структура проекта

```
.
├── face_recognition_webcam.py   # Скрипт для работы с веб-камерой
├── people_recognition_video_stream.py # Скрипт для обработки видеофайла
├── yolov12n-face.pt             # Веса модели (не включены в репозиторий)
├── screens/                     # Папка для скриншотов (создается автоматически)
└── README.md                    # Данный файл
```
## Требования

- Python 3.8+
- OpenCV
- Ultralytics YOLO
- Весовая модель YOLOv12 (совместимая с вашей версией Ultralytics)

## Примечания

Модель yolov12n-face.pt загружается на CPU (to('cpu')). Для работы на GPU замените cpu на cuda (при наличии соответствующих драйверов и библиотек).

Во втором скрипте закомментирована проверка на наличие объектов перед сохранением — все кадры будут сохранены. Будьте осторожны с длинными видео.
